<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LEGEND CORE v4.0 | Ø§Ù„Ù…Ø­Ø±Ùƒ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap');
        :root { --gold: #ffcc00; --bg: #05070a; --panel: #111827; --accent: #3b82f6; }
        body { font-family: 'Cairo', sans-serif; background: var(--bg); color: #e5e7eb; margin: 0; display: flex; justify-content: center; min-height: 100vh; }
        #app-container { width: 100%; max-width: 900px; background: var(--panel); border-right: 2px solid var(--gold); border-left: 2px solid var(--gold); position: relative; display: flex; flex-direction: column; }
        
        /* Ø´Ø§Ø´Ø§Øª Ø§Ù„Ø­Ù…Ø§ÙŠØ© */
        .auth-overlay { position: fixed; inset: 0; background: var(--bg); z-index: 1000; display: flex; align-items: center; justify-content: center; }
        .auth-card { background: var(--panel); padding: 40px; border-radius: 20px; border: 1px solid var(--gold); text-align: center; width: 350px; }
        input { width: 100%; padding: 12px; margin: 10px 0; background: #000; border: 1px solid #374151; color: #fff; border-radius: 8px; text-align: center; }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .game-header { background: #1f2937; padding: 20px; display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; border-bottom: 3px solid var(--gold); }
        .stat-item { text-align: center; background: #111; padding: 10px; border-radius: 8px; border: 1px solid #374151; }
        .stat-label { font-size: 0.7rem; color: #9ca3af; display: block; }
        .stat-val { font-weight: bold; color: var(--gold); font-size: 1.1rem; }

        /* Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        .main-content { padding: 20px; flex-grow: 1; overflow-y: auto; }
        .screen { display: none; }
        .active { display: block; animation: fadeIn 0.4s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Ø§Ù„Ù…ØªØ¬Ø± ÙˆØ§Ù„Ù‚ØµØµ */
        .grid-list { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .card { background: #1f2937; padding: 15px; border-radius: 12px; border: 1px solid #374151; transition: 0.3s; }
        .card:hover { border-color: var(--gold); transform: translateY(-5px); }
        button { width: 100%; padding: 12px; background: var(--gold); border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-family: 'Cairo'; transition: 0.2s; }
        button:hover:not(:disabled) { filter: brightness(1.2); }
        button:disabled { background: #4b5563; cursor: not-allowed; }

        /* Ø§Ù„Ù‚ØµØ© ÙˆØ§Ù„Ø£Ø­Ø¯Ø§Ø« */
        .story-engine { background: #000; padding: 25px; border-radius: 15px; border-right: 6px solid var(--gold); line-height: 1.8; font-size: 1.2rem; }
        .choice-btn { margin-top: 15px; background: #374151; }

        /* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† */
        .leaderboard { width: 100%; border-collapse: collapse; margin-top: 10px; }
        .leaderboard tr { border-bottom: 1px solid #374151; }
        .leaderboard td { padding: 12px; }
        .rank-gold { color: var(--gold); font-weight: 900; }

        .nav-bar { display: flex; background: #1f2937; border-top: 2px solid var(--gold); }
        .nav-bar button { flex: 1; border-radius: 0; background: transparent; color: #9ca3af; }
        .nav-bar button.active-nav { color: var(--gold); border-bottom: 3px solid var(--gold); }
    </style>
</head>
<body>

<div id="auth-screen" class="auth-overlay">
    <div class="auth-card">
        <h1 style="color: var(--gold)">CORE ENGINE</h1>
        <p>Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ù…Ø§ÙŠØ© ÙˆØ§Ù„ØªØ­Ù‚Ù‚</p>
        <input type="text" id="u-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
        <input type="password" id="u-pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
        <button onclick="Core.auth()">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…</button>
        <p id="auth-msg" style="color:red; font-size:0.8rem; margin-top:10px;"></p>
        <button onclick="Core.toggleRegister()" style="background:none; color:var(--accent); font-size:0.8rem;">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</button>
    </div>
</div>

<div id="app-container">
    <div class="game-header">
        <div class="stat-item"><span class="stat-label">Ø§Ù„Ù…ØºØ§Ù…Ø±</span><span id="p-name" class="stat-val">-</span></div>
        <div class="stat-item"><span class="stat-label">Ø§Ù„Ø°Ù‡Ø¨</span><span id="p-gold" class="stat-val">0</span></div>
        <div class="stat-item"><span class="stat-label">Ø§Ù„Ø§Ù†ØªØµØ§Ø±Ø§Øª</span><span id="p-wins" class="stat-val">0</span></div>
        <div class="stat-item"><span class="stat-label">Ø§Ù„Ù…Ø³ØªÙˆÙ‰</span><span id="p-lvl" class="stat-val">1</span></div>
    </div>

    <div class="main-content">
        <div id="screen-home" class="screen active">
            <div class="story-engine" id="log">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ù…Ø­Ø±Ùƒ.. Ø§Ù„Ø¹Ø§Ù„Ù… ÙŠÙ†ØªØ¸Ø± Ù‚Ø±Ø§Ø±Ø§ØªÙƒ.</div>
            <div class="grid-list" style="margin-top:20px;">
                <button onclick="Engine.mine()">â›ï¸ Ø¹Ù…Ù„ ÙÙŠ Ø§Ù„Ù…Ù†Ø¬Ù… (+500ğŸ’°)</button>
                <button onclick="Engine.quickPlay()">âš”ï¸ Ù…Ù‡Ù…Ø© Ø³Ø±ÙŠØ¹Ø©</button>
            </div>
        </div>

        <div id="screen-shop" class="screen">
            <h3>ğŸ›’ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ (100 Ù‚ØµØ©)</h3>
            <div id="shop-list" class="grid-list"></div>
        </div>

        <div id="screen-leads" class="screen">
            <h3>ğŸ† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ø´Ø±Ø© Ø§Ù„Ø£ÙˆØ§Ø¦Ù„ (Global)</h3>
            <table class="leaderboard" id="leads-list"></table>
        </div>
    </div>

    <div class="nav-bar">
        <button onclick="UI.nav('home', this)" class="active-nav">Ø§Ù„Ø³Ø§Ø­Ø©</button>
        <button onclick="UI.nav('shop', this)">Ø§Ù„Ù…ØªØ¬Ø±</button>
        <button onclick="UI.nav('leads', this)">Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ†</button>
        <button onclick="location.reload()">Ø®Ø±ÙˆØ¬</button>
    </div>
</div>

<script>
    const Core = {
        isReg: false,
        adminPass: "teem2026", // ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±Ùƒ ÙŠØ§ ØªÙŠÙ…

        auth() {
            const n = document.getElementById('u-name').value.trim();
            const p = document.getElementById('u-pass').value.trim();
            if(!n || !p) return;

            // Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø·ÙˆØ±
            if(n === "Ø§Ù„Ù…Ø·ÙˆØ±" && p === this.adminPass) {
                Engine.init(n, true);
                return;
            }

            let db = JSON.parse(localStorage.getItem('users_core') || '{}');
            if(this.isReg) {
                if(db[n]) return alert("Ø§Ù„Ø§Ø³Ù… Ù…ÙˆØ¬ÙˆØ¯!");
                db[n] = { pass: p, gold: 0, wins: 0, lvl: 1, unlocked: [1] };
                localStorage.setItem('users_core', JSON.stringify(db));
                alert("ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„!"); this.toggleRegister();
            } else {
                if(db[n] && db[n].pass === p) Engine.init(n, false, db[n]);
                else alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!");
            }
        },
        toggleRegister() {
            this.isReg = !this.isReg;
            document.querySelector('#auth-screen h1').innerText = this.isReg ? "ØªØ³Ø¬ÙŠÙ„ Ø¬Ø¯ÙŠØ¯" : "CORE ENGINE";
        }
    };

    const Engine = {
        p: {}, isDev: false,
        init(name, dev, data) {
            this.isDev = dev;
            if(dev) this.p = { name: "ØªÙŠÙ… (Ø§Ù„Ù…Ø·ÙˆØ±)", gold: 9999999, wins: 8888, lvl: 99, unlocked: Array.from({length:100},(_,i)=>i+1) };
            else this.p = { name, ...data };
            
            document.getElementById('auth-screen').style.display = 'none';
            this.update();
        },
        update() {
            document.getElementById('p-name').innerText = this.p.name;
            document